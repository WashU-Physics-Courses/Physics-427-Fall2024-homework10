# Physics 427 Homework 10

__Due 11:59pm Tuesday 11/26/2024__

The deadline of this homework is one day earlier, due to the Thanksgiving break.

## 1. Sampling from a Normal Distribution (10 points)

Your first task is to implement a function that samples from a normal distribution using the Box-Muller transform (see [Lecture 22](https://www.pulsarmagnetosphere.com/PHYS-427-Fall2024/Lecture%2022/)). The Box-Muller transform takes two uniformly distributed random numbers `u1` and `u2` and transforms them into two normally distributed random numbers `x1` and `x2`:

$$
\begin{align}
x_1 &= \sqrt{-2\ln u_1}\cos(2\pi u_2) \\
x_2 &= \sqrt{-2\ln u_1}\sin(2\pi u_2)
\end{align}
$$

For our purposes, since we are just generating one single random number, we can simply carry out one of the lines above and ignore the other. This will give a random variable that is normally distributed with mean 0 and standard deviation 1.

Write your implementation of the Box-Muller transform in the `normal` function in the provide `random.h` header (marked as `TODO:`). The function takes two arguments, `mu` and `sigma`, and return a single normally distributed random number. The `mu` argument is the mean of the distribution and the `sigma` argument is the standard deviation. You will need to transform your result sampled using the method above using `mu` and `sigma`. Use the provided `uniform` function in the included header `random.h` to generate the uniformly distributed random numbers `u1` and `u2`.

I have included a test program `test_normal.cpp` that will test your implementation. It will generate 100,000 normally distributed random variables using your implementation in `random.h` and make a histogram of the results. Use it to convince yourself that your implementation is correct. Commit your `random.h` file to the repository. Also commit the output of `test_normal.cpp` as `problem1.txt` to the repository.

## 2. Brownian Motion (15 points)

Your next task is to simulate Brownian motion in 1D (see [Lecture 24](https://www.pulsarmagnetosphere.com/PHYS-427-Fall2024/Lecture%2024/)) using the normal distribution generator you wrote in Problem 1. The Brownian motion can be simulated using the following equation:

$$
x_{n+1} = x_n + \mu \Delta t + \sigma\sqrt{\Delta t}\mathcal{N}(0,1)
$$

where $\mathcal{N}(0,1)$ is a normally distributed random number with mean 0 and standard deviation 1. Use $\mu = 1.0$, $\sigma = 2.0$, and $\Delta t = 0.01$. 

Follow the motion of 100,000 particles for 1000 steps. Start each particle at $x_0 = 0$. Write your array of particle positions to an output `csv` file every 10 steps (so that you will have 100 output files in total). Plot the results in Python as histograms (look into how to use [`pyplot.hist`](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.hist.html)). Plot the exact solution to the corresponding Fokker-Planck equation on top of the histogram:

$$
f(x, t) = \frac{1}{\sigma \sqrt{2\pi t}}\exp\left(-\frac{(x-\mu t)^2}{2\sigma^2 t}\right)
$$

For better comparison without bothering about normalization, use `density=True` in your `hist` function parameters. Make a movie of your result and commit your movie to the repository as `problem2.mp4`. Commit your C++ code to the repository as `problem2.cpp`. Do not commit any output `csv` files to the repository!

## 3. Monte Carlo Integration (25 points)

In this problem, we will carry out some Monte Carlo integrations following [Lecture 23](https://www.pulsarmagnetosphere.com/PHYS-427-Fall2024/Lecture%2023/). Consider the following integral:

$$
I = \int_{-1}^1 \frac{e^{-\cos^2 x}}{\sqrt{1-x^2}} dx
$$

Write a C++ program `problem3.cpp` to carry out the integral using Monte Carlo integration. Perform the integration in two ways: (1) Using the average value formulation and (2) using the importance sampling formulation. For importance sampling, choose a suitable weight function $w(x)$ and sample from that distribution.

Your code should use $N = 100,000$ samples per integration trial and repeat the integration for 1000 times. Compute the mean and variance of the 1000 trials. As a reminder, mean is simply the average value of the 1000 trials, and the variance is given by:

$$
\mathrm{Var} = \sigma^2 = \frac{1}{N-1}\sum_{i=1}^N (I_i - \langle I\rangle )^2
$$

where $I_i$ is the value of the integral for the $i$-th trial and $\langle I\rangle$ is the mean value of the integral. Print the mean and standard deviation of the result from these two methods. Format your output in the following way (the first line is automatically generated by the random number generator and you can leave it there). Note that the standard deviation is the square root of the variance:

```
Random Seed: xxxxxxxxxxxxx
Average method:
mean: [YOUR MEAN VALUE]
std dev: [YOUR STANDARD DEVIATION]
Importance Sampling:
mean: [YOUR MEAN VALUE]
std dev: [YOUR STANDARD DEVIATION]
``` 

If your weight function is chosen and implemented correctly, you should see that the standard deviation of the importance sampling method is much smaller than the standard deviation of the average value method. The standard deviation gives you an idea of how accurate your result is.

Commit your code to the repository as `problem3.cpp`. Commit the output of your program to the repository as `problem3.txt`. If you feel the integration is somewhat slow, remember to turn on compiler optimization using the `-O3` flag.
